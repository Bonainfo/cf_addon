<odoo>
    <data>
            <!-- Message when a login is required  -->
        <template id="login_required" name="Login required for Helpdesk">
            <t t-call="website.layout">
                <div class="wrap">
                    <div class="container">
                        <div class="jumbotron mt32">
                            <center>
                                <p><i class="fa fa-sign-in fa-5x" aria-hidden="true"></i></p>
                                <p><strong> Log in required:</strong> For using Helpdesk. Please <a t-attf-href="/web/login">log in</a>.</p>
                            </center>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="review_template" name="Helpdesk">
            <t t-call="website.layout">
                <div id="wrap">
                    <div class="container oe_website_sale">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2 oe_cart">
                                <h2 class="text-center" style="font-size: 20px;color: #333333;font-weight: bold;"> Reviews</h2>
                                <div class="o_shop_discussion_rating">
                                    <div class="row">
                                        <div class="col-md-8 col-md-offset-2">
                                            <p class="text-center" style="font-size: 16px;color: #333333;font-weight: bold;"> Tpoic: <t t-esc="review.ticket_id.subject"/></p>
                                            <t t-call="website_mail.message_thread">
                                                <t t-set="object" t-value="review"/>
                                                <t t-set="rating_enable" t-value="True"/>
                                                <t t-set="chatter_mode" t-value="'post'"/>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>


        <template id="helpdesk_view" name="Helpdesk">
            <t t-call="website.layout">
                <div class="">
                    <h2> <center>Helpdesk and Support</center></h2>
                    <div class="row" >
                        <div class="col-md-12">
                            <a href="/my/helpdesk" name="all_ticket" style="color: #ffffff;background: #50588a;" class="btn btn-default pull-right">
                                <h3 class="panel-title">
                                    <i class="fa fa-users"></i>
                                    <b>All Tickets</b>
                                </h3>
                            </a>
                        </div>                    
                        <form action="/helpdesk/validate" method="post" class="checkout_autoformat" enctype="multipart/form-data">
                            <div t-attf-class="form-group #{error.get('name') and 'has-error' or ''} col-md-12 div_name">
                                <label class="control-label" for="name">Customer Name</label>
                                <input type="text" name="name" class="form-control" t-att-value="'name' in checkout and checkout['name']" />
                            </div>
                            <div t-attf-class="form-group #{error.get('email') and 'has-error' or ''} col-md-6" id="div_email">
                                <label class="control-label" for="email">Email</label>
                                <input type="email" name="email" class="form-control" t-att-value="'email' in checkout and checkout['email']" />
                            </div>
                            <div t-attf-class="form-group #{error.get('phone') and 'has-error' or ''} col-md-6" id="div_phone">
                                <label class="control-label" for="phone">Phone</label>
                                <input type="tel" name="phone" class="form-control" t-att-value="'phone' in checkout and checkout['phone']" />
                            </div>
                            <div t-attf-class="form-group #{error.get('category_id') and 'has-error' or ''} col-md-12 div_category">
                                <label class="control-label" for="category_id">Category</label>
                                <select id="category_id" name="category_id" class="form-control">
                                    <option value="">Category...</option>
                                    <t t-foreach="categories" t-as="c">
                                        <option t-att-value="c.id" t-att-selected="c.id == (category and category.id or -1)">
                                            <t t-esc="c.name" />
                                        </option>
                                    </t>
                                </select>
                            </div>
                            <div t-attf-class="form-group #{error.get('topic_id') and 'has-error' or ''} col-md-12 topic_id" t-att-style="(not category or not category.categories_topic_ids) and 'display: none'">
                                <label class="control-label" for="topic_id">Topic</label>
                                <select name="topic_id" class="form-control" data-init="1">
                                    <option value="">Topic...</option>
                                    <t t-foreach="category and category.categories_topic_ids" t-as="c">
                                        <option t-att-value="c.id" t-att-selected="c.id == (topic_id and topic_id.id or -1)">
                                            <t t-esc="c.name" />
                                        </option>
                                    </t>
                                </select>
                            </div>

                            <div t-attf-class="form-group #{error.get('subject') and 'has-error' or ''} col-md-12 div_name">
                                <label class="control-label" for="name">Subject</label>
                                <input type="text" name="subject" class="form-control" t-att-value="'subject' in checkout and checkout['subject']"/>
                            </div>
                            <div t-attf-class="form-group #{error.get('description') and 'has-error' or ''} col-md-12 div_name">
                                <label class="control-label" for="name">Description</label>
                                <textarea class="form-control o_website_form_input" placeholder="Describe in brief..."  name="description" t-att-value="'description' in checkout and checkout['description']"/>
                            </div>
                            <div class="form-group col-md-12">
                                <input name="attachment" type="file" class="file" multiple="true" data-show-upload="true" data-show-caption="true" lass="file" data-show-preview="true"/>
                            </div>
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <input type="hidden" name="submitted" value="1" />
                            <input type="hidden" name="partner_id" t-att-value="partner_id or '0'" />
                            <input type="hidden" name="callback" t-att-value="callback" />
                            <script type="text/javascript" src="https://www.google.com/recaptcha/api.js"></script>
                                <div class="col-md-12 wk_recaptcha_security_login form-group field-password" t-if ="recaptcha_security_enable">
                                    <div class="g-recaptcha" t-att-data-sitekey="env['ir.values'].sudo().get_default('helpdesk.config.settings', 'recaptcha_site_key')"/>
                                </div>

                            <div class="form-group">
                                <div class="col-md-12">
                                    <button type="submit" class="btn btn-primary" style="text-align:center">
                                        Submit 
                                    </button>
                                </div>
                            </div>
                            
                            <div class="clearfix" />
                        </form>
                    </div>
                </div>
            </t>
        </template>

        <template id="portal_my_home_menu_helpdesk" name="Portal layout: Helpdesk menu entry" inherit_id="website_portal.portal_layout" priority="30">
            <xpath expr="//ul[contains(@class,'o_portal_submenu')]" position="inside">
                <li>
                    <a href="/my/helpdesk">Helpdesk</a>
                </li>
            </xpath>
        </template>

        <template id="portal_my_home_helpdesk" name="Portal My Home: Ticket entries" inherit_id="website_portal.portal_my_home" priority="40">
            <xpath expr="//div[contains(@class,'o_my_home_content')]" position="inside">
                <h3 class="page-header">
                    <a href="/my/helpdesk">Helpdesk Tickets
                        <small class="ml8">
                            <t t-if="ticket_count">
                                <span class='badge'><t t-esc="ticket_count"/></span>
                            </t>
                            <t t-if="not ticket_count">
                                There are currently no tickets for your account.
                            </t>
                        </small>
                    </a>
                </h3>
            </xpath>
        </template>


        <template id="my_tickets" name="My Tickets">
            <t t-call="website_portal.portal_layout">
                <h3 class="page-header">
                </h3>
                <div class="row mb16">
                    <div class="col-md-6">
                        <a id="raise_ticket" href="/helpdesk" name="ticket" style="color: #ffffff;background: #50588a;" class="btn btn-default">
                            <h3 class="panel-title" ><i class="fa fa-globe"></i> <b>Create a Ticket</b> </h3>
                        </a>
                        <!-- <a href="/my/helpdesk"  name="all_ticket"  class="btn btn-default">
                            <h3 class="panel-title"><i class="fa fa-users"></i> <b>All Tickets</b> </h3>
                        </a> -->
                    </div>
                    <div class="col-md-6">
                        <div class="dropdown pull-right">
                            <button id="searchbar_filters" class="btn btn-default" type="button" data-toggle="dropdown">
                                Category: <span t-esc="searchbar_filters.get(ticket_category, {}).get('label', 'All')"/>
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="searchbar_filters">
                                <li t-foreach="searchbar_filters" t-as="option" t-att-class="ticket_category == option and 'active'">
                                    <a t-att-href="default_url + '?' + keep_query('date_begin', 'date_end', 'sortby', category=option)"><span t-esc="searchbar_filters.get(option).get('label')"/></a>
                                </li>
                            </ul>
                        </div>
                        <div class=" dropdown pull-right mr8">
                            <button id="sortby" class="btn btn-default" type="button" data-toggle="dropdown">
                                <span class="fa fa-sort" /> <span t-esc="sortings.get(sortby, {}).get('label', 'Newest')"/>
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="sortby">
                                <li t-foreach="sortings" t-as="option" t-att-class="sortby == option and 'active'">
                                    <a t-att-href="default_url + '?' + keep_query('date_begin', 'date_end', 'category', sortby=option)"><span t-esc="sortings.get(option).get('label')"/></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>                 
                
                <t t-if="not helpdesks">
                    <div class="alert alert-warning mt8" role="alert">
                        There are no Tickets.
                    </div>
                </t>
                <div t-if="helpdesks" class="panel panel-default">
                    <div class="table-responsive"><table class="table table-hover o_portal_my_doc_table">
                        <thead>
                            <tr class="active">
                                <th>Ticket</th>
                                <th class="col-md-8">Description</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="helpdesks" t-as="helpdesk">
                                <tr t-attf-id="#{helpdesk.id}">
                                    <td>
                                        <a t-attf-href="/my/helpdesk/#{helpdesk.id}?{{ keep_query() }}"><span t-esc="helpdesk.name" /></a>
                                    </td>
                                    <td><span t-field="helpdesk.subject"/></td>
                                    <td>
                                        <span class="label label-info" title="Current stage of the issue" t-esc="helpdesk.stage_id.name" />
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table></div>
                </div>
                <div t-if="pager" class="o_portal_pager text-center">
                    <t t-call="website.pager"/>
                </div>
            </t>
        </template>

        <template id="my_ticket" name="My Ticket">
            <t t-call="website.layout">
                <div id="wrap">
                    <div class="container">
                        <div class="oe_structure">
                            <div class="row">
                                <div class="col-sm-4">
                                    <ol class="breadcrumb mt8">
                                        <li><a href="/my/home"><i class="fa fa-home"/></a></li>
                                        <li>
                                            <a t-attf-href="/my/helpdesk?{{ keep_query()}}">
                                            Helpdesk
                                            </a>
                                        </li>
                                        <li>
                                            <t t-esc="helpdesk.name"/>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                             <div class="panel panel-default">
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h4>
                                                Ticket / <span t-field="helpdesk.name"/>
                                            </h4>
                                        </div>
                                    </div>
                                </div>


                                <div class="panel-body">
                                    <div class='row'>
                                        <div class="col-md-6" style="padding-left: 35px;">
                                            <h4 style="font-weight:  bold;"> Customer Details </h4>
                                            <div t-if="helpdesk.partner_id" style="padding: 3px;">
                                                <strong>Customer :</strong>  
                                                <span t-field="helpdesk.partner_id" />
                                            </div>
                                            
                                            <div t-if="helpdesk.email" style="padding: 3px;">
                                                <strong>Email :</strong>  
                                                <span t-field="helpdesk.email" />
                                            </div>
                                        </div>
                                        <div class="col-md-6" style="border-left: 1px solid transparent;padding-left: 35px;border-left-width: 3px;border-left-color: #f5f5f5;">
                                            <h4 style="font-weight:  bold;">  Assignee Details </h4>
                                            <div t-if="helpdesk.user_id" style="padding: 3px;">
                                                <strong>Assigned To :</strong>  
                                                <span t-field="helpdesk.user_id" />
                                            </div>
                                            <div t-if="helpdesk.category_id" style="padding: 3px;">
                                                <strong>Category :</strong>  
                                                <span t-field="helpdesk.category_id" />
                                            </div>
                                            <div t-if="helpdesk.create_date" style="padding: 3px;">
                                                <strong>Create Date :</strong>  
                                                <span t-field="helpdesk.create_date" />
                                            </div>
                                        </div>
                                    </div>
                                    <hr style="color:  #f5f5f5; margin-top:20px;margin-bottom:20px;padding:0px;border-width: 2px;" />
                                    <div class="col-md-12">
                                        <h4 style="font-weight:  bold;"> Ticket Details </h4>
                                        <div t-if="helpdesk.subject" style="padding: 3px;">
                                            <strong>Title :</strong>  
                                            <span t-field="helpdesk.subject" />
                                        </div>
                                        <div t-if="helpdesk.topic_id" style="padding: 3px;">
                                            <strong>Topic :</strong>  
                                            <span t-field="helpdesk.topic_id" />
                                        </div>
                                        <div t-if="helpdesk.name" style="padding: 3px;">
                                            <strong>Ticket No. :</strong>  
                                            <span t-field="helpdesk.name" />
                                        </div>
                                        <div t-if="helpdesk.create_uid" style="padding: 3px;">
                                            <strong>Created By :</strong>  
                                            <span t-field="helpdesk.create_uid" />
                                        </div>
                                        <div t-if="helpdesk.priority" style="padding: 3px;" >
                                            <strong>Priority :</strong>  
                                            <span t-field="helpdesk.priority" />
                                        </div>
                                        <div t-if="helpdesk.description" style="padding: 3px;">
                                            <strong>Description :</strong>  
                                            <span t-raw="helpdesk.description" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt32">
                                <div class="col-md-12">
                                    <h4><strong>Message and communication history</strong></h4>
                                </div>
                                <div class="col-md-10 col-md-offset-1 mt16">
                                    <t t-call="website_mail.message_thread">
                                        <t t-set="object" t-value="helpdesk"/>
                                        <t t-set="chatter_mode" t-value="'json'"/>
                                        <t t-set="rating_enable" t-value="False"/>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

    </data>
</odoo>